/**
 * å¤šåª’ä½“æ§åˆ¶ç»„ä»¶
 * æ§åˆ¶éŸ³ä¹æ’­æ”¾ã€æ”¶éŸ³æœºç­‰åŠŸèƒ½
 */
@Component
export struct MediaControlPanel {
  @State isPlaying: boolean = false;
  @State currentTrack: string = 'æœªé€‰æ‹©æ­Œæ›²';
  @State volume: number = 50;
  @State isRadioMode: boolean = false;

  build() {
    Column() {
      // æ ‡é¢˜
      Text('ğŸµ å¤šåª’ä½“æ§åˆ¶')
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
        .fontColor('#333333')
        .margin({ bottom: 20 })
        .selfAlign(ItemAlign.Start)
      
      // æ¨¡å¼åˆ‡æ¢
      this.renderModeSwitch()
      
      // éŸ³ä¹æ’­æ”¾æ§åˆ¶
      if (!this.isRadioMode) {
        this.renderMusicControls()
      } else {
        this.renderRadioControls()
      }
      
      // éŸ³é‡æ§åˆ¶
      this.renderVolumeControl()
    }
    .width('100%')
    .backgroundColor('#FFFFFF')
    .borderRadius(12)
    .padding(20)
    .shadow({ radius: 6, color: '#00000010', offsetX: 0, offsetY: 2 })
  }

  /**
   * æ¸²æŸ“æ¨¡å¼åˆ‡æ¢
   */
  @Builder
  renderModeSwitch() {
    Row() {
      Button('éŸ³ä¹')
        .backgroundColor(this.isRadioMode ? '#E0E0E0' : '#2196F3')
        .fontColor(this.isRadioMode ? '#666666' : '#FFFFFF')
        .layoutWeight(1)
        .margin({ right: 8 })
        .onClick(() => {
          this.isRadioMode = false;
        })
      
      Button('æ”¶éŸ³æœº')
        .backgroundColor(this.isRadioMode ? '#2196F3' : '#E0E0E0')
        .fontColor(this.isRadioMode ? '#FFFFFF' : '#666666')
        .layoutWeight(1)
        .margin({ left: 8 })
        .onClick(() => {
          this.isRadioMode = true;
        })
    }
    .width('100%')
    .height(40)
    .margin({ bottom: 20 })
  }

  /**
   * æ¸²æŸ“éŸ³ä¹æ§åˆ¶
   */
  @Builder
  renderMusicControls() {
    Column() {
      // å½“å‰æ­Œæ›²ä¿¡æ¯
      Column() {
        Text(this.currentTrack)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .fontColor('#333333')
          .margin({ bottom: 4 })
        
        Text('æœªçŸ¥è‰ºæœ¯å®¶')
          .fontSize(14)
          .fontColor('#666666')
      }
      .margin({ bottom: 20 })
      
      // æ’­æ”¾æ§åˆ¶æŒ‰é’®
      Row() {
        Button('â®ï¸')
          .width(50)
          .height(50)
          .backgroundColor('#F5F5F5')
          .fontColor('#333333')
          .borderRadius(25)
          .margin({ right: 20 })
          .onClick(() => {
            this.previousTrack();
          })
        
        Button(this.isPlaying ? 'â¸ï¸' : 'â–¶ï¸')
          .width(60)
          .height(60)
          .backgroundColor('#2196F3')
          .fontColor('#FFFFFF')
          .borderRadius(30)
          .margin({ left: 20, right: 20 })
          .onClick(() => {
            this.togglePlayPause();
          })
        
        Button('â­ï¸')
          .width(50)
          .height(50)
          .backgroundColor('#F5F5F5')
          .fontColor('#333333')
          .borderRadius(25)
          .margin({ left: 20 })
          .onClick(() => {
            this.nextTrack();
          })
      }
      .margin({ bottom: 20 })
      
      // è¿›åº¦æ¡
      Row() {
        Text('0:00')
          .fontSize(12)
          .fontColor('#999999')
        
        Slider({
          value: 30,
          min: 0,
          max: 100,
          style: SliderStyle.OutSet
        })
        .layoutWeight(1)
        .padding({ left: 10, right: 10 })
        .onChange((value: number) => {
          console.info('Progress changed:', value);
        })
        
        Text('3:45')
          .fontSize(12)
          .fontColor('#999999')
      }
      .width('100%')
      .alignItems(VerticalAlign.Center)
    }
  }

  /**
   * æ¸²æŸ“æ”¶éŸ³æœºæ§åˆ¶
   */
  @Builder
  renderRadioControls() {
    Column() {
      // å½“å‰é¢‘ç‡
      Text('FM 101.1 MHz')
        .fontSize(24)
        .fontWeight(FontWeight.Bold)
        .fontColor('#333333')
        .margin({ bottom: 20 })
      
      // é¢‘é“é¢„è®¾
      Row() {
        ForEach(['89.1', '91.5', '97.4', '101.1', '103.8'], (freq: string) => {
          Button(freq)
            .backgroundColor('#E0E0E0')
            .fontColor('#333333')
            .borderRadius(8)
            .margin({ right: 8 })
            .onClick(() => {
              this.tuneFrequency(freq);
            })
        })
      }
      .margin({ bottom: 20 })
      
      // è°ƒé¢‘æ§åˆ¶
      Row() {
        Button('â¬‡ï¸')
          .width(50)
          .height(50)
          .backgroundColor('#F5F5F5')
          .borderRadius(25)
          .margin({ right: 20 })
          .onClick(() => {
            this.tuneDown();
          })
        
        Text('è°ƒèŠ‚é¢‘ç‡')
          .fontSize(16)
          .fontColor('#333333')
          .layoutWeight(1)
          .textAlign(TextAlign.Center)
        
        Button('â¬†ï¸')
          .width(50)
          .height(50)
          .backgroundColor('#F5F5F5')
          .borderRadius(25)
          .margin({ left: 20 })
          .onClick(() => {
            this.tuneUp();
          })
      }
    }
  }

  /**
   * æ¸²æŸ“éŸ³é‡æ§åˆ¶
   */
  @Builder
  renderVolumeControl() {
    Column() {
      Row() {
        Text('ğŸ”ˆ')
          .fontSize(20)
          .margin({ right: 10 })
        
        Text(`éŸ³é‡: ${this.volume}%`)
          .fontSize(14)
          .fontColor('#666666')
          .layoutWeight(1)
      }
      .width('100%')
      .margin({ bottom: 10 })
      
      Slider({
        value: this.volume,
        min: 0,
        max: 100,
        style: SliderStyle.OutSet
      })
      .width('100%')
      .onChange((value: number) => {
        this.volume = Math.round(value);
        this.onVolumeChange(this.volume);
      })
    }
    .margin({ top: 20 })
  }

  /**
   * åˆ‡æ¢æ’­æ”¾/æš‚åœ
   */
  private togglePlayPause(): void {
    this.isPlaying = !this.isPlaying;
    console.info('Play/Pause toggled:', this.isPlaying);
  }

  /**
   * ä¸Šä¸€é¦–
   */
  private previousTrack(): void {
    console.info('Previous track');
  }

  /**
   * ä¸‹ä¸€é¦–
   */
  private nextTrack(): void {
    console.info('Next track');
  }

  /**
   * è°ƒèŠ‚éŸ³é‡
   */
  private onVolumeChange(volume: number): void {
    console.info('Volume changed to:', volume);
  }

  /**
   * è°ƒé¢‘å‘ä¸Š
   */
  private tuneUp(): void {
    console.info('Tuning up');
  }

  /**
   * è°ƒé¢‘å‘ä¸‹
   */
  private tuneDown(): void {
    console.info('Tuning down');
  }

  /**
   * è°ƒè‡³æŒ‡å®šé¢‘ç‡
   */
  private tuneFrequency(freq: string): void {
    console.info('Tuning to frequency:', freq);
  }
}