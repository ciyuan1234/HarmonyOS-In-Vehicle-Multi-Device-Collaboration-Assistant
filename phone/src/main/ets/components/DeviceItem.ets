import { DeviceInfo, DeviceType } from '../../../../shared/src/main/ets/model/DeviceModel';

/**
 * è®¾å¤‡åˆ—è¡¨é¡¹ç»„ä»¶
 */
@Component
export struct DeviceItem {
  @Prop device: DeviceInfo;
  @Prop onSelect?: (device: DeviceInfo) => void;

  build() {
    Row() {
      // è®¾å¤‡å›¾æ ‡
      this.renderDeviceIcon()
      
      // è®¾å¤‡ä¿¡æ¯
      Column() {
        Text(this.device.deviceName)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .fontColor('#333333')
        
        Text(`${this.getDeviceTypeName(this.device.deviceType)} Â· ${this.device.isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}`)
          .fontSize(12)
          .fontColor(this.device.isOnline ? '#4CAF50' : '#999999')
          .margin({ top: 2 })
      }
      .alignItems(HorizontalAlign.Start)
      .layoutWeight(1)
      
      // çŠ¶æ€æŒ‡ç¤ºå™¨å’Œç”µæ± ä¿¡æ¯
      Column() {
        // åœ¨çº¿çŠ¶æ€æŒ‡ç¤ºå™¨
        Circle()
          .width(8)
          .height(8)
          .fill(this.device.isOnline ? '#4CAF50' : '#999999')
        
        // ç”µæ± ä¿¡æ¯
        if (this.device.batteryLevel !== undefined) {
          Text(`${this.device.batteryLevel}%`)
            .fontSize(10)
            .fontColor('#666666')
            .margin({ top: 4 })
        }
      }
      .alignItems(HorizontalAlign.End)
    }
    .padding(12)
    .backgroundColor('#FFFFFF')
    .borderRadius(8)
    .margin({ bottom: 8 })
    .onClick(() => {
      if (this.onSelect) {
        this.onSelect(this.device);
      }
    })
  }

  /**
   * æ¸²æŸ“è®¾å¤‡ç±»å‹å›¾æ ‡
   */
  @Builder
  renderDeviceIcon() {
    Row() {
      switch (this.device.deviceType) {
        case DeviceType.PHONE:
          Text('ğŸ“±')
            .fontSize(24)
          break;
        case DeviceType.CAR:
          Text('ğŸš—')
            .fontSize(24)
          break;
        case DeviceType.WATCH:
          Text('âŒš')
            .fontSize(24)
          break;
        default:
          Text('ğŸ“±')
            .fontSize(24)
      }
    }
    .width(40)
    .height(40)
    .justifyContent(FlexAlign.Center)
    .backgroundColor('#F5F5F5')
    .borderRadius(20)
    .margin({ right: 12 })
  }

  /**
   * è·å–è®¾å¤‡ç±»å‹åç§°
   */
  private getDeviceTypeName(type: DeviceType): string {
    switch (type) {
      case DeviceType.PHONE: return 'æ‰‹æœº';
      case DeviceType.CAR: return 'è½¦æœº';
      case DeviceType.WATCH: return 'æ‰‹è¡¨';
      default: return 'æœªçŸ¥è®¾å¤‡';
    }
  }
}